library(devtools)
devtools::install_github("hadley/devtools")
install.packages("devtools")
library(devtools)
install_github("carolinafishes/PhyInformR")
setwd("Dropbox/My Mac (Michaelâ€™s MacBook Pro)/Documents/GitHub/2019_fall_UH_Systematics_class/Homework_assignment4/")
library(phytools)
tree<-read.tree("Anolis.tre")
plotTree(tree,ftype="i",lwd=1)
plotTree(tree,ftype="i",lwd=1)
svl<-read.csv("svl.csv",row.names=1)
svl<-setNames(svl$svl,rownames(svl))
svl
fit<-fastAnc(tree,svl,vars=TRUE,CI=TRUE)
print(fit,printlen=10)
range(svl)
obj<-contMap(tree,svl,plot=FALSE)
obj
plot(obj,legend=0.7*max(nodeHeights(tree)), sig=2,fsize=c(0.7,0.9))
## Descrete trait evolution
eel.trees<-read.nexus("anguila.nex")
eel.data<-read.csv("elopomorph.csv",row.names=1)
## Descrete trait evolution
library(geiger)
chk<-name.check(eel.trees[[1]],eel.data)
chk
eel.trees<-lapply(eel.trees,drop.tip,chk$tree_not_data)
class(eel.trees)<-"multiPhylo"
x<-setNames(eel.data[,1],rownames(eel.data))
x
mapped.trees<-make.simmap(eel.trees,x,model="ARD",message=FALSE)
mapped.trees
obj<-summary(mapped.trees,check.equal=TRUE)
colors<-setNames(c("red","blue"),c("bite","suction"))
plot(obj,ftype="i",fsize=0.7,colors=colors)
add.simmap.legend(x=0,y=5,prompt=FALSE,colors=colors,shape="circle")
plot(obj,ftype="i",colors=colors)
colors<-setNames(c("red","blue"),c("bite","suction"))
plot(obj,ftype="i",colors=colors)
add.simmap.legend(x=0,y=5,prompt=FALSE,colors=colors,shape="circle")
plot(obj,colors=colors)
add.simmap.legend(x=0,y=5,prompt=FALSE,colors=colors,shape="circle")
cons.tree<-consensus.edges(eel.trees,method="least.squares")
obj<-summary(mapped.trees,ref.tree=cons.tree)
plot(obj,ftype="i",fsize=0.7,colors=colors)
add.simmap.legend(x=0,y=5,prompt=FALSE,colors=colors,shape="circle")
